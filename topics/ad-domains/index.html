<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Metacoda Pty Ltd">
  
  <title>Active Directory Domains - Metacoda Identity Sync Utilities</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Active Directory Domains";
    var mkdocs_page_input_path = "topics/ad-domains.md";
    var mkdocs_page_url = "/topics/ad-domains/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Metacoda Identity Sync Utilities</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Intro</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Topics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../idsp/">Identity Sync Profiles & Process</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Active Directory Domains</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#active-directory-domains">Active Directory Domains</a></li>
                
                    <li><a class="toctree-l4" href="#single-domain-single-idsp">Single Domain / Single IDSP</a></li>
                
                    <li><a class="toctree-l4" href="#multiple-domains-single-forest-single-idsp">Multiple Domains / Single Forest / Single IDSP</a></li>
                
                    <li><a class="toctree-l4" href="#multiple-domains-multiple-forests-hybrid-idsp">Multiple Domains / Multiple Forests / Hybrid IDSP</a></li>
                
                    <li><a class="toctree-l4" href="#foreign-security-principals">Foreign Security Principals</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../canonical-tables/">Using Canonical Tables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../exclusions/">Exclusions & Exceptions</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Reference</span></li>

        
            
    <ul class="subnav">
    <li><span>SAS Macros</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaExtIdExtract/">%metacodaExtIdExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaExtIdUpdate/">%metacodaExtIdUpdate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaIdentityGroupExtract/">%metacodaIdentityGroupExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaIdentityLoginExtract/">%metacodaIdentityLoginExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaPersonEmailExtract/">%metacodaPersonEmailExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaPersonExtract/">%metacodaPersonExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaPersonIntLoginExtract/">%metacodaPersonIntLoginExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaPersonLocationExtract/">%metacodaPersonLocationExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaPersonPhoneExtract/">%metacodaPersonPhoneExtract</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../sasautos/metacodaXMLEncode/">%metacodaXMLEncode</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Samples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../samples/idsp-samples/">Sample Identity Sync Profiles</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../samples/sas-samples/">Sample SAS Programs</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../resources/">Resources</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>About</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../about/license/">License</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../about/trademarks/">Trademarks</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Metacoda Identity Sync Utilities</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Topics &raquo;</li>
        
      
    
    <li>Active Directory Domains</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/metacoda/idsync-utils/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="active-directory-domains">Active Directory Domains</h1>
<p>This section describes some of the common scenarios when synchronising SAS metadata with Microsoft
Active Directory (AD) domains and how Metacoda Identity Sync Profiles (IDSPs) can support these.</p>
<h2 id="single-domain-single-idsp">Single Domain / Single IDSP</h2>
<p>The most common scenario is synchronising with a single domain. This can be supported with a single
IDSP as described in the <em>Single (Basic) Identity Sync Profile</em> section of
<a href="../idsp/">Identity Sync Profiles &amp; Process</a> and illustrated below:</p>
<p><img alt="Identity Sync Process Diagram" src="../img/idsync-single-ad-domain.png" /></p>
<h2 id="multiple-domains-single-forest-single-idsp">Multiple Domains / Single Forest / Single IDSP</h2>
<p>Sometimes it is necessary to synchronise with multiple AD domains. If these domains are all within
the same AD forest then this can also be supported with a single IDSP. When following the well
known <a href="https://en.wikipedia.org/wiki/AGDLP">AGDLP or AGUDLP</a> models for organising groups that span
domains, the IDSP can target groups in one of the domains and the Metacoda Identity Sync process
will follow group members into other domains in the same forest as shown in the diagram below.</p>
<p><img alt="Identity Sync Process Diagram" src="../img/idsync-single-ad-forest-groups.png" /></p>
<p>The IDSP targets the AU domain in the AU forest. The Finance Domain Local group is one of the
included groups. When processing group members, the Finance Universal group includes a Finance
Global group from the EU domain (in the same forest) so all of its members are also considered
for synchronisation.  </p>
<p>The Identity Sync Process for this scenario is very similar to the single domain scenario except
that the source identity extraction process can return members from multiple domains in the same
forest. The following diagram illustrates this variation.   </p>
<p><img alt="Identity Sync Process Diagram" src="../img/idsync-single-ad-forest.png" /></p>
<p>In scenarios like this, where multiple domains are involved, you will most likely want to choose
pseudo-attributes, such as <em>sAMAccountNameWithDomain</em>, that automatically include the name of the
source domain (as dynamically determined from the directory) when choosing attributes mappings
in the Identity Sync Profile Wizard.</p>
<h2 id="multiple-domains-multiple-forests-hybrid-idsp">Multiple Domains / Multiple Forests / Hybrid IDSP</h2>
<p>When SAS metadata identities need to be sourced from multiple AD domains, across multiple AD
forests, it is necessary to use a Hybrid IDSP with at least one child IDSP per forest.
For more information on Hybrid IDSPs see the <em>Multiple (Hybrid) Identity Sync Profiles</em> section of
<a href="../idsp/">Identity Sync Profiles &amp; Process</a>.</p>
<p>The diagram below illustrates the Identity Sync Process for this scenario, where there are two
AD domains, D1 and D2, which are in different AD forests. There are two child IDSPs, one for each
domain, wrapped up in a Hybrid IDSP. </p>
<p><img alt="Identity Sync Process Diagram" src="../img/idsync-hybrid-ad-domains.png" /></p>
<h2 id="foreign-security-principals">Foreign Security Principals</h2>
<p>Occasionally when dealing with multiple domains you may encounter the following error message
during the Identity Sync Process:</p>
<p><em>Failed to fetch included AD groups: Can't follow Foreign-Security-Principal into trusted domain
for AD identity (with DN 'CN=S-1-5-21-1234567890-123456789-123456789-1234,CN=ForeignSecurityPrincipals,DC=d1,DC=example,DC=com').</em></p>
<p>This is an error generated to highlight the fact that at least one of the targeted groups in the D1
domain contains a member from a domain in a different forest. This indicates a situation where
there are multiple AD forests with trust relationships. Whilst the single IDSP scenarios support
following groups into domains within the same forest, they do not support following groups into
domains in other forests. To synchronise with multiple domains across one or more forests it is
necessary to use Hybrid IDSPs and, if required, modify any affected child IDSPs to ensure they
ignore Foreign Security Principals.</p>
<p>To ignore Foreign Security Principals, the IDSP will need to be modified using a text editor, and
the <em>foreignSecurityPrincipalHandling</em> attribute added to the <em>LDAPConfig</em> tag with a value of
<em>ignore</em> like so:</p>
<pre><code>    &lt;LDAPConfig
    ...
    foreignSecurityPrincipalHandling="ignore"
    /&gt;
</code></pre>
<p>This will ignore any group members that come from another forest (instead of generating an error).
If those members are actually required in SAS metadata then you will need to ensure that they are
within a targeted group in the hybrid child IDSP that corresponds to that foreign domain.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../canonical-tables/" class="btn btn-neutral float-right" title="Using Canonical Tables">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../idsp/" class="btn btn-neutral" title="Identity Sync Profiles & Process"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2017 <a href="https://www.metacoda.com/">Metacoda Pty Ltd</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/metacoda/idsync-utils/" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../idsp/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../canonical-tables/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
